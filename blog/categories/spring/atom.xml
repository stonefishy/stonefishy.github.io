<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Spring | Stonefishy Blog]]></title>
  <link href="http://stonefishy.github.io/blog/categories/spring/atom.xml" rel="self"/>
  <link href="http://stonefishy.github.io/"/>
  <updated>2015-05-19T22:59:51+08:00</updated>
  <id>http://stonefishy.github.io/</id>
  <author>
    <name><![CDATA[Yu]]></name>
    <email><![CDATA[andrewsy@live.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[How to Use Jdbc in Spring]]></title>
    <link href="http://stonefishy.github.io/blog/2015/05/05/how-to-use-jdbc-in-spring/"/>
    <updated>2015-05-05T16:31:53+08:00</updated>
    <id>http://stonefishy.github.io/blog/2015/05/05/how-to-use-jdbc-in-spring</id>
    <content type="html"><![CDATA[<p>As we know, we can use <code>jdbc</code> to access database in java programming. And now let us use <code>jdbc</code> in spring. The <code>spring framework</code> reduces developer handlers any accessing database exception, because it deal with them internally. The spring framework integrated the jdbctemplate, they are <code>org.springframework.jdbc.datasource.DriverManagerDataSource</code> and <code>org.springframework.jdbc.core.JdbcTemplate</code>.</p>

<p>And here we use the <code>hsqldb</code> to act as our memory database. You can go to <a href="http://hsqldb.org/">here</a> to look at it. we use the <code>Maven</code> tools to management our project. the dependencies is:</p>

<!-- more -->


<pre><code class="">&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
            &lt;version&gt;4.1.6.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
            &lt;version&gt;4.1.6.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
            &lt;version&gt;4.1.6.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
            &lt;version&gt;4.1.6.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.hsqldb&lt;/groupId&gt;
            &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;
            &lt;version&gt;1.8.0.10&lt;/version&gt;
        &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>

<p>The spring configure file:</p>

<pre><code>&lt;!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN"
            "http://www.springframework.org/dtd/spring-beans-2.0.dtd"&gt;

&lt;beans&gt;

    &lt;bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"&gt;
        &lt;property name="driverClassName" value="org.hsqldb.jdbcDriver"/&gt;
        &lt;property name="url" value="jdbc:hsqldb:mem:MyDB"/&gt;
        &lt;property name="username" value="sa"/&gt;
        &lt;property name="password" value=""/&gt;
    &lt;/bean&gt;

    &lt;bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate"&gt;
         &lt;constructor-arg&gt;
            &lt;ref bean="dataSource"/&gt;
         &lt;/constructor-arg&gt;    
    &lt;/bean&gt;

    &lt;bean id="createTable" class="java4s.SpringJdbcCreateTable"&gt;
        &lt;property name="jt"&gt;
            &lt;ref bean="jdbcTemplate"/&gt;
        &lt;/property&gt;
    &lt;/bean&gt;

&lt;/beans&gt;  
</code></pre>

<p>we have a SpringJdbcCreateTable class to accesss database, this class has <code>JdbcTemplate</code> property,</p>

<pre><code class="java">JdbcTemplate jt;

public void setJt(JdbcTemplate jt) {
    this.jt = jt;
}
</code></pre>

<p>we use spring bean to inject value to this property. And you will see it in above spring configure file.</p>

<p>create table, the <code>execute</code> method doesn&rsquo;t return value.</p>

<pre><code class="java ">public void createTable() {
    jt.execute("CREATE TABLE user(id int, name varchar(10), age int)");
    // execute() returns void
    System.out.println("table created");
}
</code></pre>

<p>insert data, using the <code>update</code> method to insert data, this method will return how many rows have been inserted.</p>

<pre><code class="java">public void insertData() {
    int k = jt.update("INSERT INTO user VALUES (99, 'user_99', 49)");
    showDatas();

    System.out.println(String.format("%s row inserted", k));
}
</code></pre>

<p>update data, using the <code>update</code> method to update data, it will return how many rows are affected.</p>

<pre><code class="java">public void updateData() {
    int k = jt.update("UPDATE user set name='user_new' where name='user_99'");
    showDatas();

    System.out.println(String.format("%s row updated", k));
}
</code></pre>

<p>delete data, also using the <code>update</code> method.</p>

<pre><code class="java">public void deleteData() {
    int k = jt.update("DELETE from user where name='user_new'");

    showDatas();
    System.out.println(String.format("%s row deleted", k));
}
</code></pre>

<p>query data, the jdbctemplate has many query interfaces. Here we use <code>queryForRowSet</code> method to get the data by condition.</p>

<pre><code class="java">
private void showDatas() {
    System.out.println("|  ID |  NAME    |  AGE  |");
    SqlRowSet rowSet = jt.queryForRowSet("SELECT * FROM user");

    while (rowSet.next()) {
        int id = rowSet.getInt(1);
        String name = rowSet.getString(2);
        int age = rowSet.getInt(3);

        String msg = String
                .format("|  %s  |  %s  |  %s   |", id, name, age);

        System.out.println(msg);
    }       
}
</code></pre>

<p>okay, to so far, let us call them in main entrance.</p>

<pre><code class="java">public static void main(String args[])
{
    ApplicationContext applicationContext = new ClassPathXmlApplicationContext("spconfig.xml");
    SpringJdbcCreateTable st =(SpringJdbcCreateTable)applicationContext.getBean("createTable");

    st.createTable();
    st.initSomeDatas();
    st.insertData();
    st.updateData();
    st.deleteData();
}
</code></pre>

<p>Look, it&rsquo;s very easy to access database with spring framework.</p>
]]></content>
  </entry>
  
</feed>
